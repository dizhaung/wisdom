<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Wisdom Query Guide - Wisdom Stream Processor</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Wisdom Query Guide";
    var mkdocs_page_input_path = "query-guide.md";
    var mkdocs_page_url = "/query-guide/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Wisdom Stream Processor</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../why-wisdom/">Why Wisdom?</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../getting-started/">Getting Started</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../deploy-wisdom/">Deploy Wisdom</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Wisdom Query Guide</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#stream">Stream</a></li>
    

    <li class="toctree-l2"><a href="#filter">Filter</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#window">Window</a></li>
        
            <li><a class="toctree-l3" href="#select">Select</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Use Cases</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../intrusion-detection/">Intrusion Detection</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Wisdom Stream Processor</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Wisdom Query Guide</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>A Wisdom application can be created either using Java API or Wisdom Query Language. Wisdom Query Language is a SQL like query inspired by <a href="https://wso2.github.io/siddhi/">Siddhi Query</a>. A Wisdom query should follow this template:</p>
<pre><code class="text">&lt;app annotation&gt;?
( &lt;stream definition&gt; | &lt;variable definition&gt; | ... ) + 
( &lt;query&gt; ) +
;
</code></pre>

<h1 id="stream">Stream</h1>
<p>Stream is a the most basic component of stream processor. In Wisdom, you need to define a stream before using it. Wisdom streams are dynamic typed like Python so you cannot define attributes of s stream. At the runtime, whatever you pass will be accepted by the stream.</p>
<p><strong>Java API:</strong></p>
<pre><code class="java">app.defineStream(&quot;StockStream&quot;);
</code></pre>

<p><strong>Wisdom Query:</strong></p>
<pre><code class="java">def stream StockStream;
</code></pre>

<h1 id="filter">Filter</h1>
<p>Filter is an operator to filter events coming from a stream. In Wisdom query, a <code>filter</code> can be used anywhere in between <code>from</code> and <code>insert into</code> statements.</p>
<p><strong>Java API:</strong></p>
<pre><code class="java">app.defineQuery(&quot;query1&quot;)
    .from(&quot;StockStream&quot;)
    .filter(event -&gt; &quot;UWO&quot;.equals(event.get(&quot;stock&quot;)))
    .insertInto(&quot;OutputStream&quot;);
</code></pre>

<p>In Java API, the <code>filter</code> method accepts any <code>java.util.function.Predicate&lt;Event&gt;</code> as the argument. For user's convenient, Wisdom offers some built-in predicates:</p>
<ul>
<li>Operator.EQUALS</li>
<li>Operator.GREATER_THAN</li>
<li>Operator.GREATER_THAN_OR_EQUAL</li>
<li>Operator.LESS_THAN</li>
<li>Operator.LESS_THAN_OR_EQUAL</li>
<li>Operator.STR_IN_ATTR and its variants</li>
</ul>
<p>Above code can be written using built-in <code>Operator.EQUALS</code> predicate as shown below:</p>
<pre><code class="java">app.defineQuery(&quot;query1&quot;)
    .from(&quot;StockStream&quot;)
    .filter(Operator.EQUALS(&quot;stock&quot;, &quot;AMAZON&quot;))
    .insertInto(&quot;OutputStream&quot;);
</code></pre>

<p><strong>Wisdom Query:</strong></p>
<pre><code class="java">from StockStream
filter symbol == 'UWO'
insert into OutputStream;
</code></pre>

<p>Wisdom Query supports the following logical operators: <code>==</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code> and <code>in</code></p>
<h2 id="window">Window</h2>
<p>Windows are used to batch events based on some conditions. Wisdom 0.0.1 supports the following windows:</p>
<ul>
<li>Window.length</li>
<li>Window.lengthBatch</li>
<li>Window.externalTimeBatch</li>
<li>UniqueWindow.lengthBatch</li>
<li>UniqueWindow.externalTimeBatch</li>
</ul>
<p><strong>Java API:</strong></p>
<pre><code class="java">app.defineQuery(&quot;query1&quot;)
    .from(&quot;StockStream&quot;)
    .window(Window.lengthBatch(3))
    .insertInto(&quot;OutputStream&quot;);
</code></pre>

<p><strong>Wisdom Query:</strong></p>
<pre><code class="java">from StockStream
window.lengthBatch(3)
insert into OutputStream;
</code></pre>

<h2 id="select">Select</h2>
<p>Selector selects attributes and events to be inserted into the following operator. If the selector is used with attribute names, it selects the attributes from events. If selector is used with index of events after windows, it selects the specified events from the list of events.</p>
<p>NOTE: Positive indices select events from the begining of list and negative indices select events from the end of list. For example <code>0</code> selects the first event and <code>-1</code> selects the last event.</p>
<p><strong>Java API:</strong></p>
<p>Select <code>symbol</code> and <code>price</code> from all events and insert them into OutputStream.</p>
<pre><code class="java">app.defineQuery(&quot;query1&quot;)
    .from(&quot;StockStream&quot;)
    .select(&quot;symbol&quot;, &quot;price&quot;)
    .insertInto(&quot;OutputStream&quot;);
</code></pre>

<p>Select last two events from window and insert them into OutputStream.</p>
<pre><code class="java">app.defineQuery(&quot;query1&quot;)
    .from(&quot;StockStream&quot;)
    .window.lengthBatch(5)
    .select(Index.of(-2, -1))
    .insertInto(&quot;OutputStream&quot;);
</code></pre>

<p><strong>Wisdom Query:</strong></p>
<p>Select <code>symbol</code> and <code>price</code> from all events and insert them into OutputStream.</p>
<pre><code class="java">from StockStream
select symbol, price
insert into OutputStream;
</code></pre>

<p>Select last two events from window and insert them into OutputStream.</p>
<pre><code class="java">from StockStream
select -2, -1
insert into OutputStream;
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../intrusion-detection/" class="btn btn-neutral float-right" title="Intrusion Detection">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../deploy-wisdom/" class="btn btn-neutral" title="Deploy Wisdom"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../deploy-wisdom/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../intrusion-detection/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js"></script>
      <script src="../search/require.js"></script>
      <script src="../search/search.js"></script>

</body>
</html>
